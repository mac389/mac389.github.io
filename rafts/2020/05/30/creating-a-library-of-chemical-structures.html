<!DOCTYPE html>
<html>

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Creating A Library of Chemical Structures
  </title>
  <meta name="description" content="Creating a Library">
  <link rel="stylesheet" href="http://localhost:4000/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2020/05/30/creating-a-library-of-chemical-structures.html">
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <meta name="google-site-verification" content="3MYPLcVtIrIJAq-zUX83Yq9dvsLEhvtcq3ea8GktHTs">
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-15405704-2"></script>

  

  <link rel="stylesheet" href="/css/main.css">
  
</head>


  <body>

    <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <!-- Move the navbar-collapse div outside of the navbar-header div -->
    <div class="collapse navbar-collapse" id="navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
        
        
        
        <li class="active">
          <a href="/">Chary Lab @ Weill Cornell</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/team">Team</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/publications">Publications</a>
        </li>
        
        
        
        
        
        <li class="dropdown ">
          <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Research <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li>
              <a href="/research">Contribution to Science</a>
            </li>
            
            
            
            <li>
              <a href="/dnp">2,4-dinitrophenol</a>
            </li>
            
            
            
            <li>
              <a href="/morphosyntax">Morphosyntax</a>
            </li>
            
            
            
            <li>
              <a href="/lesser_older_projects">Lesser or Older Projects</a>
            </li>
            
            
            
            <li>
              <a href="/onboarding">Onboarding</a>
            </li>
            
            
          </ul>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/intoxicate">INTOXICATE</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/jarvis">Jarvis</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/ekg">EKGs</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/notebooks">Notebooks</a>
        </li>
        
        
      </ul>
    </div>
  </div>
</nav>


    <div class="container-fluid">
      <div class="row">
        <style>ol.bibliography li { list-style: none }</style>


  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Creating A Library of Chemical Structures
  </title>
  <meta name="description" content="Creating a Library">
  <link rel="stylesheet" href="http://localhost:4000/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2020/05/30/creating-a-library-of-chemical-structures.html">
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <meta name="google-site-verification" content="3MYPLcVtIrIJAq-zUX83Yq9dvsLEhvtcq3ea8GktHTs">
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-15405704-2"></script>

  

  <link rel="stylesheet" href="/css/main.css">
  

 
<nav class="navbar navbar-default navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <!-- Move the navbar-collapse div outside of the navbar-header div -->
    <div class="collapse navbar-collapse" id="navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        
        
        
        
        
        <li class="active">
          <a href="/">Chary Lab @ Weill Cornell</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/team">Team</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/publications">Publications</a>
        </li>
        
        
        
        
        
        <li class="dropdown ">
          <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Research <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            
            <li>
              <a href="/research">Contribution to Science</a>
            </li>
            
            
            
            <li>
              <a href="/dnp">2,4-dinitrophenol</a>
            </li>
            
            
            
            <li>
              <a href="/morphosyntax">Morphosyntax</a>
            </li>
            
            
            
            <li>
              <a href="/lesser_older_projects">Lesser or Older Projects</a>
            </li>
            
            
            
            <li>
              <a href="/onboarding">Onboarding</a>
            </li>
            
            
          </ul>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/intoxicate">INTOXICATE</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/jarvis">Jarvis</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/ekg">EKGs</a>
        </li>
        
        
        
        
        
        <li class="">
          <a href="/notebooks">Notebooks</a>
        </li>
        
        
      </ul>
    </div>
  </div>
</nav>


<section class="post--content">
  <br><br><br>
  <p class="post--date">30 May 2020 (Last Modified 01 Jun 2022)</p>
<br>
    
  <p></p>
<h2>Creating A Library of Chemical Structures</h2>
   <h5 id="outstanding-questions">Outstanding Questions.</h5>
<ol>
  <li>How to quantify the structural heterogeneity of each field?</li>
  <li>How to distinguish between agonists and antagonists?</li>
</ol>

<h4 id="goal">Goal.</h4>

<p>For my <a href="/ann_latent_reps_drugs">Analysis of Latent Spaces</a> I created a convolutional neural network (<em>link</em>) to classify compounds as belonging to drug categories. To obtain the drug categories and their labels.</p>

<p>The divide between the everyday terminology clinicians use and the formal language of the NDCs can effect observational studies <a class="citation" href="#defalco2013applying">(DeFalco et al., 2013)</a>, but our input here is SMILES strings.</p>

<h4 id="creating-a-representative-training-set">Creating a Representative Training Set.</h4>
<p>One consideration when creating the training data sets was to have enough samples of novel psychoactive substances so that the relative magnitudes of the fractional classifications would be meaningful.</p>

<p>Training Set Should Have</p>
<ol>
  <li>Comparable Numbers of Compounds from Each Class</li>
  <li>Comparable Subclasses of Compounds within Each Class (<em>e.g.</em>, opiates, semisynthetic opioids, opioids, novel opioids)</li>
</ol>

<p>Classes (Is there a pre-existing classification I could use?). Links to CSV only work if you are a known collaborator for this project.</p>
<ol>
  <li>Opioid (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/external/opioids/phase1_oxcatop.csv">CSV one</a> and <a href="https://github.com/mac389/molecular-cnn/blob/main/data/external/opioids/phase2_oxcatop.csv">two</a>)</li>
  <li>Tryptamine (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/psychoactive-tryptamines-substances-list.csv">CSV</a>)</li>
  <li>Phenethylamine (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/substituted-and-historic-phenethylamines.tsv">CSV</a>)</li>
  <li>Benzodiazepine(<a href="https://github.com/mac389/molecular-cnn/blob/main/data/benzodiazepine_list.tsv">CSV</a>)</li>
  <li>Beta-blocker (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/beta_receptor_blockers.tsv">CSV</a>)</li>
  <li>Calcium Channel Blocker (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/calcium_channel_blockers_training_list.tsv">CSV</a>)</li>
  <li>Cannabinoids (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/cannabinoids_training_list.tsv">CSV</a>)</li>
</ol>

<ul>
  <li><a href="/2020/06/03/details-on-database-of-molecular-structures.html">Extended Discussion on DB Creation</a></li>
</ul>

<p>Testing sets:</p>
<ol>
  <li>Ergolines (<a href="https://github.com/mac389/molecular-cnn/blob/main/data/ergoline-validation-substances-list.csv">CSV</a>)</li>
</ol>

<p>I used <a href="http://projects.scbdd.com/pybiomed.html">PyBioMed</a> (<a href="https://github.com/gadsbyfly/PyBioMed">Git Hub Repo</a>, <a href="https://pybiomed.readthedocs.io/en/latest/application.html#application-3-prediction-of-drugtarget-interaction-from-the-integration-of-chemical-and-protein-spaces">Tutorial</a>) and <a href="https://chemspipy.readthedocs.io/en/latest/guide/intro.html#obtaining-an-api-key">ChemSiPy</a>. Here is a good <a href="https://www.altexsoft.com/blog/drug-data-openfda-dailymed-rxnorm-goodrx/">overview</a> of the databases describing apporved sustances (<em>NB</em> openFDA might be useful)</p>

<h4 id="code-narration">Code Narration.</h4>

<p>I used <code class="language-plaintext highlighter-rouge">requests</code> to query RxNorm.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">requests</span>
<span class="n">URL</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://rxnav.nlm.nih.gov/REST/rxclass/classMembers.json</span><span class="sh">"</span>
<span class="n">query</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">classId</span><span class="p">:</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">classId</span><span class="sh">"</span><span class="p">:</span> <span class="n">classId</span><span class="p">,</span><span class="sh">"</span><span class="s">relaSource</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">ATC</span><span class="sh">"</span><span class="p">})</span>
</code></pre></div></div>

<p>The keyword <code class="language-plaintext highlighter-rouge">relaSource</code> refers to the relationship that must hold between the drug and class for a drug to be considered a member of the class. I’m not sure why, but while the source of the relationship has to be specified, the object of the relationship is optional. The <a href="https://lhncbc.nlm.nih.gov/RxNav/APIs/api-RxClass.getClassMembers.html">documentation</a> does not explain this design choice.</p>

<table>
  <thead>
    <tr>
      <th>Compound Class</th>
      <th>Data Source</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Opioids</td>
      <td> </td>
    </tr>
    <tr>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<h4 id="resources-i-used">Resources I used.</h4>

<ol>
  <li>Wikipedia: <a href="https://en.wikipedia.org/wiki/List_of_psychedelic_drugs#Serotonergic_psychedelics_(serotonin_5-HT2A_receptor_agonists)">List of psychedelic substances</a>
</li>
  <li>Wikipedia: <a href="https://en.wikipedia.org/wiki/List_of_designer_drugs">List of designer drugs</a>
</li>
  <li>Wikipedia: <a href="https://en.wikipedia.org/wiki/List_of_substances_used_in_rituals">List of substances used in rituals</a>
</li>
  <li>Wikipedia: <a href="https://en.wikipedia.org/wiki/Substituted_phenethylamine">Substituted phenethylamines</a>
</li>
  <li>
</li>
</ol>

<h5 id="opioids">Opioids.</h5>
<p>I used the following Resources.</p>
<ol>
  <li>Oxford’s <a href="https://www.catalogueofopioids.net/">Catalogue of Opioids</a> <a class="citation" href="#richards2021oxford">(Richards et al., 2021)</a>
</li>
</ol>

<p>The Wikipedia page, <a href="https://en.wikipedia.org/wiki/List_of_psychedelic_drugs">List of Pyschoactive Substances</a> detailed serotonergic agonists and cannabinoid receptor agonists, which I extracted as</p>

<p>I didn’t include the benzofuran derivatives, dimemebfe, also known as 5-MeO-BFE and 5-MeO-DiBF because nither is, structurally, a tryptamine.</p>

<h5 id="tryptamines">Tryptamines.</h5>
<p>I began with the Wikipedia page. I excluded LSD derivatives because they contain phenethylamine. The <em>D</em> stands for diethylamide. I saved them in [filename] because I think they are a good test for the CNN. I expect them to classify LSD and LSD derivatives as partly tryptamine and partly phenethylamine.</p>

<h4 id="cannabinoids">Cannabinoids</h4>
<p>I excluded HU-211 because it binds to NMDA as well as CB receptors. (<a href="https://en.wikipedia.org/wiki/Dexanabinol">Wikipedia</a> suggests it has therapeutic uses.) HU-211 is the enantiomer of HU-210. The structural diversity of cannabinoids could be a second paper.</p>

<h4 id="bibliography">Bibliography</h4>
<ol class="bibliography">
<li><span id="richards2021oxford">1.Richards, G. C., Sitkowski, K., Heneghan, C. &amp; Aronson, J. K. The Oxford Catalogue of Opioids: A systematic synthesis of opioid drug names and their pharmacology. <i>British journal of clinical pharmacology</i> <b>87</b>, 3790–3812 (2021).</span></li>
<li><span id="defalco2013applying">2.DeFalco, F. J., Ryan, P. B. &amp; Soledad Cepeda, M. Applying standardized drug terminologies to observational healthcare databases: a case study on opioid exposure. <i>Health Services and Outcomes Research Methodology</i> <b>13</b>, 58–67 (2013).</span></li>
</ol>

</section>


      </div>
    </div>

    <div id="footer" class="panel">
  <div class="panel-footer">
	<div class="container-fluid">
	  <div class="row">
		<div class="col-sm-4">
			
		  <p>© 2020 Chary Lab. Site made with <a href="https://jekyllrb.com">Jekyll</a>;  <a href="http://localhost:4000/aboutwebsite.html">copy and modify this template for your own research group.</a></p>
              <p>We are part of the <a href="https://emed.weill.cornell.edu/">Department of Emergency Medicine</a> at <a href="https://weill.cornell.edu/">Weill Cornell Medical College</a>.</p>
		   <p>  </p>
<p>
            		  
            
		</p>
</div>
		<div class="col-sm-4">
		  Funding:
		  <ul> 
         <li> Loan Repayment Program from National Institute of Drug Abuse 
         </li>
<li> American College of Medical Toxicology
     </li>
</ul>
		</div>
		<!-- <div class="col-sm-4"> put contact information here  -->
		</div> 
	  </div>
	</div>
  </div>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>



  <script src="https://unpkg.com/mermaid@8.9.3/dist/mermaid.min.js"></script>
<script>
  $(document).ready(function () {
    mermaid.initialize({
      startOnLoad:true,
      theme: "default",
    });
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  });
</script>


  </body>

</html>
